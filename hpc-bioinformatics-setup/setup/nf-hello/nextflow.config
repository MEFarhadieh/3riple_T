workDir = System.getenv('NXF_WORK') ?: "${baseDir}/work"

process {
  errorStrategy = 'retry'
  maxRetries    = 1
  // Let Slurm decide placement
}

profiles {

  // Slurm executor using your cluster
  slurm {
    process {
      executor = 'slurm'
      // queue = 'short'          // <- uncomment & set if your site requires a partition
      // clusterOptions = '--account=YOUR_ACCOUNT'  // <- uncomment if you need an account
    }
    // Lightweight run telemetry
    timeline { enabled = true; file = "${baseDir}/timeline.html" }
    report   { enabled = true; file = "${baseDir}/report.html"   }
    trace    { enabled = true; file = "${baseDir}/trace.txt"     }
    dag      { enabled = true; file = "${baseDir}/flow.svg"      }
  }

  // Turn on Singularity and use a tiny container (pulls via your *_CACHEDIR)
  singularity {
    singularity.enabled = true
    process.container   = 'docker://alpine:3.19'
    // Optional: keep task sandboxes on node-local tmp
    // process.scratch = true
  }

  // Pure Conda demo (no root needed), environment defined below
  conda {
    conda.enabled = true
    conda.cacheDir = System.getenv('CONDA_PKGS_DIRS') ?: "${baseDir}/.conda_pkgs"
  }
}
